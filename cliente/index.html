<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Strike Command: Dominio Total</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="./cliente/css/game-styles.css">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" integrity="sha512-3j3VU6WC5rPQB4Ld1jnLV7Kd5xr+cq9avvhwqzbH/taCRNURoeEpoPBK9pDyeukwSxwRPJ8fDgvYXd6SkaZ2TA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        /* Estilos adicionales para z-index */
        .modal { z-index: 5000 !important; }
        .modal-backdrop { z-index: 4500 !important; }
        /* Google One Tap styling */
        .google-signin-container {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
        }
    </style>

    <script src="./cliente/clienteRest.js"></script>
    <script src="./cliente/controlWeb.js"></script>
    <script src="./cliente/clienteWS.js"></script>

</head>
<body class="game-body">
    <!-- Google One Tap -->
    <div id="googleSigninContainer" class="google-signin-container">
        <div id="g_id_onload"
            data-client_id="270733010519-a35099usqc22lr9400m7m7pp3ngheseb.apps.googleusercontent.com"
            data-login_uri="/oneTap/callback"
            data-skip_prompt_cookie="nick"
        ></div>
        <div class="g_id_signin" data-type="standard" data-shape="rectangular" data-theme="outline" data-text="signin_with" data-size="large" data-logo_alignment="left"></div>
    </div>

    <!-- Barra de usuario (se muestra cuando est√° logueado) -->
    <div id="userBar" class="user-bar" style="display: none;">
        <div class="user-info">
            <div class="user-avatar" id="userAvatar">?</div>
            <span class="user-name" id="userName">Usuario</span>
        </div>
        <button id="btnUserLogout" class="btn-back">Cerrar Sesi√≥n</button>
    </div>

    <!-- Contenedor principal del juego -->
    <div class="game-container">
        <!-- Header del juego -->
        <div class="game-header">
            <h1 class="game-logo">Strike Command</h1>
            <p class="game-subtitle">Dominio Total</p>
            
            <!-- Iconos de dominio -->
            <div class="domain-icons">
                <div class="domain-icon air" title="Dominio A√©reo">‚úàÔ∏è</div>
                <div class="domain-icon sea" title="Dominio Naval">üö¢</div>
                <div class="domain-icon land" title="Dominio Terrestre">üéñÔ∏è</div>
            </div>
        </div>

        <!-- Zona de mensajes -->
        <div id="msg" class="mb-3"></div>
        
        <!-- Zona donde se cargan formularios de login/registro -->
        <div id="registro" class="mb-3"></div>
        
        <!-- √Årea principal de contenido -->
        <div id="au"></div>
    </div>
    <!-- The Modal -->
    <div class="modal" id="miModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">‚ö†Ô∏è Atenci√≥n</h4>
                    <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
                </div>
                <!-- Modal body -->
                <div class="modal-body" id="mBody"></div>
                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>       
    <script>
        cw = new ControlWeb();
        rest = new ClienteRest(cw);
        ws = new ClienteWS();
        
        // Inicializaci√≥n de la interfaz: preguntar al servidor si hay sesi√≥n
        cw.comprobarSesion();

        // Handler para el bot√≥n de logout en la barra superior
        $("#btnUserLogout").on("click", function(e) {
            e.preventDefault();
            cw.salir();
        });
    </script>
</body>
</html>